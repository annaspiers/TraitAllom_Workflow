#==========================================================================================#
#==========================================================================================#
#     This sub-routine makes the first letter of every entry capitalised, whilst leaving   #
# the other letters lower case.                                                            #
# Original subroutine comes from the help on toupper.  Here I modified it just to deal     #
# with NAs.                                                                                #
#------------------------------------------------------------------------------------------#

#==========================================================================================#
#==========================================================================================#
#      This function deletes spaces from strings, trimming.  Default is to trim both       #
# sides, but you can also trim the left or the right only.                                 #
#------------------------------------------------------------------------------------------#
str.trim <<- function(x,side="both"){
   if (side %in% c("both","left") ) x = sub(pattern="^\\s+",replacement="",x=x)
   if (side %in% c("both","right")) x = sub(pattern="\\s+$",replacement="",x=x)
   return(x)
}#end function str.trim
#==========================================================================================#
#==========================================================================================#






#==========================================================================================#
#==========================================================================================#
#       This function is similar to paste0, but for printing stuff on screen.              #
#------------------------------------------------------------------------------------------#
cat0 <<- function(...,file="",fill=FALSE,labels=NULL,append=FALSE){
   cat(...,"\n",file=file,fill=fill,sep="",labels=labels,append=append)
}#end cat0
#==========================================================================================#
#==========================================================================================#






#==========================================================================================#
#==========================================================================================#
#       This function is similar to Fortran adjust left.                                   #
#------------------------------------------------------------------------------------------#
adjust.left <<- function(x,width=NULL){
   if (is.null(width)) width   = max(nchar(x))
   names.x = names(x)

   out        = sapply( X   = x
                      , FUN = function(x,w){
                                 ans                     = rep(" ",times=w)
                                 ans[sequence(nchar(x))] = unlist(strsplit(x=x,split=""))
                                 ans                     = paste(ans,collapse="")
                                 return(ans)
                              }#end FUN
                      , w   = width
                      )#end sapply
   names(out) = names.x
   return(out)
}#end adjust.left
#==========================================================================================#
#==========================================================================================#






#==========================================================================================#
#==========================================================================================#
#       This function is similar to Fortran adjust right.                                  #
#------------------------------------------------------------------------------------------#
adjust.right <<- function(x,width){
   if (is.null(width)) width      = max(nchar(x))
   fmt        = paste0("%",width,"s")
   out        = sprintf(fmt,x)
   names(out) = names(x)
   return(out)
}#end adjust.right
#==========================================================================================#
#==========================================================================================#






#==========================================================================================#
#==========================================================================================#
#       This function is similar to gregexpr, but it returns the number of occurrences of  #
# pattern.                                                                                 #
#------------------------------------------------------------------------------------------#
nregexpr <<- function(pattern,text,...){
   if (length(text) > 1){
      ans = mapply(FUN=nregexpr,text=text,MoreArgs=list(pattern=pattern),SIMPLIFY=TRUE)
   }else{
      #---- Use gregexpr to identifiy the number of occurrences. --------------------------#
      ans = gregexpr(pattern=pattern,text=text,...)[[1]]
      ans = length(ans[ans %gt% 0])
      #------------------------------------------------------------------------------------#
   }#end if (length(text) > 1)
   #---------------------------------------------------------------------------------------#

   #----- Answer. -------------------------------------------------------------------------#
   names(ans) = names(text)
   return(ans)
   #---------------------------------------------------------------------------------------#
}#end function nregexpr
#==========================================================================================#
#==========================================================================================#
